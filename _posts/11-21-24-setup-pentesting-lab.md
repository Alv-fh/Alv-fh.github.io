---
title: Configurar un Laboratorio de Pentesting con VirtualBox 游농
description: Veremos c칩mo configurar un Laboratorio de Pentesting en VirtualBox para practicar.
date: 2024-11-21
categories: [VirtualBox, CTF, Pentesting]
tags: [VirtualBox, CTF, Pentesting, Machines]
img_path: "assets/img/pivoting-ejptv2.png"
image: "assets/img/pivoting-ejptv2.png"
---

# 游농 C칩mo configurar tu propio laboratorio para practicar Pivoting en VirtualBox

- [游농 C칩mo configurar tu propio laboratorio para practicar Pivoting en VirtualBox](#-c칩mo-configurar-tu-propio-laboratorio-para-practicar-pivoting-en-virtualbox)
    - [Introducci칩n](#introducci칩n)
    - [VirtualBox](#virtualbox)
    - [Requisitos Previos](#requisitos-previos)
    - [Paso 1: Instalar VirtualBox y Configurarlo](#paso-1-instalar-virtualbox-y-configurarlo)
    - [Paso 2: Crear y Configurar diferentes Redes NAT](#paso-2-crear-y-configurar-diferentes-redes-nat)
    - [Paso 3: Crear y Configurar M치quinas Virtuales](#paso-3-crear-y-configurar-m치quinas-virtuales)
      - [- M치quina atacante, en mi caso (Kali Linux)](#--m치quina-atacante-en-mi-caso-kali-linux)
      - [- M치quinas Vulnerables, en este caso de Vulnyx](#--m치quinas-vulnerables-en-este-caso-de-vulnyx)
    - [Paso 4: Comprobar el Funcionamiento de todo el Laboratorio](#paso-4-comprobar-el-funcionamiento-de-todo-el-laboratorio)
    - [Paso 5: Realizar Laboratorio y Comprobar que la otra Red Funciona](#paso-5-realizar-laboratorio-y-comprobar-que-la-otra-red-funciona)
    - [Mi opini칩n](#mi-opini칩n)

### Introducci칩n

En este post, exploraremos detalladamente c칩mo crear un laboratorio en VirtualBox dise침ado espec칤ficamente para practicar t칠cnicas de pivoting. Este entorno no solo es ideal para entender conceptos fundamentales de redes y explotaci칩n, sino que tambi칠n est치 enfocado en proporcionar una experiencia pr치ctica alineada con los objetivos de la certificaci칩n eLearnSecurity Junior Penetration Tester (eJPTv2).

El laboratorio simula un escenario realista donde ser치 necesario navegar entre diferentes redes y equipos para comprometer sistemas, aplicar t칠cnicas de redireccionamiento de tr치fico y lograr acceso a m치quinas que de otra manera ser칤an inaccesibles. A lo largo de este tutorial, configuraremos varias m치quinas virtuales, organizadas en subredes conectadas estrat칠gicamente, y emplearemos herramientas clave.

Si est치s prepar치ndote para la eJPTv2 o simplemente deseas mejorar tus habilidades en pentesting, este laboratorio es una excelente manera de fortalecer tus conocimientos en un entorno controlado.

### VirtualBox

VirtualBox es una herramienta de virtualizaci칩n gratuita y ampliamente utilizada. Permite crear y ejecutar m칰ltiples m치quinas virtuales (VMs) en tu ordenador, ideal para montar un entorno de pr치ctica de pentesting. Con VirtualBox, puedes simular redes reales y trabajar con m치quinas vulnerables, evitando cualquier riesgo para tu red principal.

### Requisitos Previos

Antes de empezar, aseg칰rate de tener lo siguiente:

- PC con suficiente capacidad de RAM y almacenamiento.

- VirtualBox

- ISO o im치genes de m치quinas virtuales vulnerables.

### Paso 1: Instalar VirtualBox y Configurarlo

- Descarga VirtualBox desde el sitio oficial de Oracle e inst치lalo.

  [游댕 **Enlace de Descarga**](https://www.virtualbox.org/wiki/Downloads)

- **Configuraci칩n de Preferencias**: En "Preferencias" de VirtualBox, define el directorio donde se almacenar치n las m치quinas virtuales.

### Paso 2: Crear y Configurar diferentes Redes NAT

- En este paso crearemos distintas redes NAT ya que vamos a configurar este laboratorio para poder realizar **pivoting**.

- Creaci칩n y Configuraci칩n de una Red NAT:

  - **Paso 2.1** -> Entramos en la configuraci칩n de red de VirtualBox
  
  ![2](/assets/img/ctf-build/2.png)
  
  - **Paso 2.2** -> Entramos en **Redes NAT** y luego a **Crear** para crear una Red NAT.
  
  ![3](/assets/img/ctf-build/3.png)

  - **Paso 2.3** -> A continuaci칩n editaremos el nombre y el rango de IP de nuestra red privada (NAT). Dejaremos desactivadas las IPv6.
    
    En funci칩n de la clase de la IP, cambiar치 la m치scara de subred. En mi caso es **Clase C** por lo que ser칤a **/24**.
  
  ![4](/assets/img/ctf-build/4.png)

  - **Paso 2.4** -> Le damos a **Aplicar** para crer la red NAT.
  
  ![5](/assets/img/ctf-build/5.png)

  - **Paso 2.5** -> Crearemos otra red NAT para este laboratorio. Se llama콋a **Alv-Red2** y el rango ser치 **172.17.2.0/24**

  ![9](/assets/img/ctf-build/9.png)

### Paso 3: Crear y Configurar M치quinas Virtuales

#### - M치quina atacante, en mi caso (Kali Linux)

- Tendremos **2 Tarjetas de Red**. Para poder acceder a Internet y tener conexi칩n con otras m치quinas. No "sabremos" la otra tarjeta de red y la tendremos que descubrir (Esa es la gracia).

  - **Paso 3.1** -> En el **Adaptador 1** tendremos la tarjeta que se podr치 conectar con Internet. En mi caso la he puesto **NAT**
    
    *쯇or qu칠 NAT?*

    - Por el simple hecho de que brinda m치s seguridad ya que crea una subred privada creada por VirtualBox y adem치s tenemos conexi칩n con el exterior si el PC anfitri칩n tiene.
    
    - B치sicamente es como si el equipo real estuviera intercambiando tr치fico, ya que se hace NAT sobre la direcci칩n IP privada real del equipo en cuesti칩n.

  ![6](/assets/img/ctf-build/6.png)

  - **Paso 3.2** -> En el **Adaptador 2** tendremos la Red NAT **Alv-Red** que ser치 la red privada que conocemos con nuestro Kali.

    - Activaremos el modo promiscuo para poder ver el tr치fico de la red.
  
  ![10](/assets/img/ctf-build/10.png)  
  
  - **Paso 3.3** -> Le damos a Aceptar para aplicar cambios.

![11](/assets/img/ctf-build/11.png)

#### - M치quinas Vulnerables, en este caso de [Vulnyx](https://vulnyx.com/)

- 1췈 M치quina: [Wicca](https://mega.nz/file/YbBDjQDI#vV964toDsXFloNjT0sfIZ1mmTC23EiGUiJ3HIdDeqD8)

  - **Paso 3.4** -> Esta m치quina solo tendr치 una red, que es la red interna **Alv-Red** tenemos en nuestro Kali. Ser치 de despiste, pero para practicar, la tendremos que hackear.  

![8](/assets/img/ctf-build/8.png)

- 2췈 M치quina (Puente): [Eternal](https://mega.nz/file/kPIiwRhZ#wiO8ddEp3LN7fZLfjF77A--VJtB8wsp6qakYJyx1wfU)

  - **Paso 3.5** -> Esta ser치 la m치quina Puente, con la que realizaremos el Pivoting. Para ello tendremos 2 tarjetas de Red.

    - Tarjeta de Red 1: Red NAT -> **Alv-Red**

    ![11](/assets/img/ctf-build/12.png)

    - Tarjeta de Red 2: Red NAT -> **Alv-Red2**

    Aqu칤 estar치 la otra red oculta que tenemos que descubrir.

    1 - Entraremos en el **Adaptador 2**.

    2 - Elegiremos **Red NAT**.

    3 - Seleccionamos nuestra red creada.

    4 - Permitimos el modo promiscuo para poder ver el tr치fico de la red.

    5 - Le damos a Aceptar para aplicar cambios.

    ![13](/assets/img/ctf-build/13.png)

- 3췈 M치quina (Red Oculta): [Fire](https://mega.nz/file/hfwwgZQS#PrlxyDa-eAT_PtA66Qx1Hb255gpxCXKFhTUQkH75qpw)

  - **Paso 3.6** -> Esta m치quina ser치 la oculta, la que solo tiene conexi칩n con la m치quina puente. Estar치 en la Red **Alv-Red2**.

![14](/assets/img/ctf-build/14.png)

### Paso 4: Comprobar el Funcionamiento de todo el Laboratorio

- Comprobamos que se ha configurado todo correctamente escaneando la red y comprobando las tarjetas de red.

- Para ello:

  - **Paso 4.1** -> Entramos en Kali Linux y comprobamos las tarjetas de red con el comando `ip a`

    - eth0 -> Es nuestra primera tarjeta de red que est치 en NAT con IP: 10.0.2.15

    - eth1 -> Es nuestra red privada (Alv-Red) con IP: 10.10.10.4
  
    ![15](/assets/img/ctf-build/15.png)
  
  - **Paso 4.2** -> Hacemos un escaneo de la red privada para descubrir nuevos hosts `sudo arp-scan -I eth1 --localnet`

  ![16](/assets/img/ctf-build/16.png)

  - Vemos posibles hosts que est치n en la red.
  
  - **Paso 4.3** -> Hago ping a cada IP y deduzco lo siguiente:

  10.10.10.3 -> Switch o Router | TTL=255

  10.10.10.5 -> M치quina Windows | TTL=128

  10.10.10.6 -> M치quina Linux | TTL=64
  
  ![17](/assets/img/ctf-build/17.png)

### Paso 5: Realizar Laboratorio y Comprobar que la otra Red Funciona

- Por 칰ltimo empezariamos a hacer el laboratorio hackeando cada m치quina y comprobariamos que funciona haciendo pivoting.

- Para ello dejo un enlace resolviendo este laboratorio en mi canal de youtube:

[游댕 **Link del v칤deo**](https://www.youtube.com/watch?v=-snSRa6pOOM)

### Mi opini칩n

Creo que es una muy buena idea implementar un laboratorio de este estilo para familiarizarnos con t칠cnicas como el pivoting ya que la configuraci칩n es muy sencilla y la tenemos en un plis plas. Podemos poner la dificultad que queramos a침adiendo m치s m치quinas, m치quinas m치s dif칤ciles, b치sicamente es muy personalizable.